let shipsetting={},showshiplist={},hidelist=[],current_shipid="",current_shiprar="",newshipid="",fleetpos="",current_equipid="",current_equiptype="",ani="animation: runtext 3s linear alternate infinite;";function setlang(t){let e=t.id,n=document.querySelectorAll(".boxtext[cn]"),i=0,l=0;"cn"===e&&(l=11),n.forEach(t=>{setTimeout(()=>{let n=t.getAttribute(e);n.len()>=11?t.setAttribute("style",ani):t.removeAttribute("style"),t.textContent=n},i),i++})}function sorting(t,e,n){return n?(t.sort((t,n)=>t[e]<n[e]?1:-1),t):(t.sort((t,n)=>t[e]>n[e]?1:-1),t)}function setshipbutton(){"front"===fleetpos?(document.getElementById("ffs").style.display="inline",document.getElementById("fbs").style.display="none"):(document.getElementById("ffs").style.display="none",document.getElementById("fbs").style.display="inline")}function setcurrent(t){"shipicon"===t.className?(current_shipid=String(t.id),fleetpos=t.getAttribute("limit"),shipdisplay(0),setshipbutton()):(current_equipid=String(t.id),current_equiptype=t.getAttribute("eqtype"),equipdisplay(t))}function setnewship(t){newshipid=String(t)}function sEquipButton(t,e){let n=t.querySelectorAll(".equip");n.forEach(t=>{t.textContent="",t.style=""}),e?n.forEach(t=>{t.disabled=!1;let e="equip_"+t.getAttribute("pos"),n=ship_data[newshipid];t.setAttribute("eqtype",n[e]),t.setAttribute("stype",n.type)}):n.forEach(t=>t.disabled=!0)}function updateship(t){let e=document.getElementById(current_shipid),n=document.getElementById(current_shipid.slice(0,3));if(e.textContent="",setnewship(t),0===t)return e.setAttribute("style","background:gray;"),void sEquipButton(n,!1);e.setAttribute("style","background:none;"),sEquipButton(n,!0),document.getElementById(newshipid).querySelectorAll(".container,.textbox").forEach(t=>e.appendChild(t.cloneNode(!0)))}function updateEquip(t){let e=document.getElementById(current_equipid);e.textContent="",0!==t.id?(e.setAttribute("style","background:none;"),document.getElementById(t.id).querySelectorAll(".container,.textbox").forEach(t=>e.appendChild(t.cloneNode(!0)))):e.setAttribute("style","background-color:rgb(30.8%, 30.8%, 30.8%);")}function getcolor(t){let e="";switch(t){case 1:case 2:e="lightgray";break;case 3:e="lightblue";break;case 4:e="Plum";break;case 5:e="Gold";break;case 6:e="OrangeRed"}return e}function createmptyship(){let t=document.getElementById("shiplist"),e=document.createElement("button");$(e).attr({type:"button",class:"shipicon",id:"0",style:"display:inline;","data-dismiss":"modal",onclick:"updateship(0)"});let n=document.createElement("img");$(n).attr({src:"shipicon/empty.jpg",class:"main",loading:"lazy"});let i=document.createElement("div");$(i).attr({class:"container itembox"}),i.appendChild(n);let l=document.createElement("div");$(l).attr({class:"textbox"});let a=document.createElement("div");$(a).attr({class:"boxtext text-nowrap small"}),a.textContent="remove",l.appendChild(a),e.appendChild(i),e.appendChild(l),t.appendChild(e),creatallships()}function creatallships(){let t=[],e=0;for(let e in ship_data)t.push(ship_data[e]);t=sorting(t,"type",!0),t=sorting(t,"nationality",!0),(t=sorting(t,"rarity",!0)).forEach(t=>{setTimeout(function(){let e=t,n=document.getElementById("shiplist"),i=document.createElement("button"),l=e.rarity-1;$(i).attr({type:"button",class:"shipicon",id:e.skin_id,style:"display:inline; background:none;","data-dismiss":"modal",onclick:"updateship("+e.skin_id+")"});let a=document.createElement("img");$(a).attr({src:"shipicon/"+e.painting.toLowerCase()+".png",class:"main",loading:"lazy"});let s=document.createElement("img");$(s).attr({src:"ui/bg"+l+".png",class:"bg",loading:"lazy"});let r=document.createElement("img");$(r).attr({src:"ui/frame_"+l+"b.png",class:"frame",loading:"lazy"});let o=document.createElement("div"),d="",p="";for(let t=0;t<e.star+1;t++){if(t>0&&t!=e.star)d+=",",p+=",";else if(t===e.star){d+=";",p+=";";break}d+="url(ui/star.png)",p+=10*t+"px"}$(o).attr({class:"star",style:"background-image:"+d+"background-position:"+p});let c=document.createElement("div");$(c).attr({class:"container itembox"}),c.appendChild(a),c.appendChild(s),c.appendChild(r),c.appendChild(o);let u=document.createElement("div");$(u).attr({class:"textbox"});let m=document.createElement("div");$(m).attr({class:"boxtext text-nowrap small",cn:e.cn_name,en:e.en_name,jp:e.jp_name}),m.textContent=e.cn_name,e.cn_name.len()>=11&&m.setAttribute("style",ani),u.appendChild(m),i.appendChild(c),i.appendChild(u),n.appendChild(i)},e),e++}),creatallequips(e)}function runasync(t,e=0){return setTimeout(t,e)}function creatallequips(t){let e=[];for(let t in equip_data)e.push(equip_data[t]);e=sorting(e,"nationality",!0),e=sorting(e,"type",!1),(e=sorting(e,"rarity",!0)).forEach(e=>{setTimeout(function(){let t=e,n=document.getElementById("equiplist"),i=document.createElement("button"),l=t.rarity;l>1&&l--,$(i).attr({type:"button",class:"equip",id:t.id,style:"display:inline; background-color:none;","data-dismiss":"modal",onclick:"updateEquip(this)"});let a=document.createElement("img");$(a).attr({src:"equips/"+String(t.icon)+".png",class:"img-rounded img-fluid h-100 main",loading:"lazy"});let s=document.createElement("img");$(s).attr({src:"ui/bg"+l+".png",class:"bg",loading:"lazy"});let r=document.createElement("img");$(r).attr({src:"ui/frame_"+l+"b.png",class:"frame",loading:"lazy"});let o=document.createElement("div"),d="",p="";for(let e=0;e<t.rarity+1;e++){if(e>0&&e!=t.rarity)d+=",",p+=",";else if(e===t.rarity){d+=";",p+=";";break}d+="url(ui/star.png)",p+=10*e+"px"}$(o).attr({class:"star",style:"background-image:"+d+"background-position:"+p});let c=document.createElement("div");$(c).attr({class:"container itembox"}),c.appendChild(a),c.appendChild(s),c.appendChild(r),c.appendChild(o);let u=document.createElement("div");$(u).attr({class:"textbox"});let m=document.createElement("div");$(m).attr({class:"boxtext text-nowrap small",cn:t.cn_name,en:t.en_name,jp:t.jp_name}),m.textContent=t.cn_name,t.cn_name.len()>=11&&m.setAttribute("style",ani),u.appendChild(m),i.appendChild(c),i.appendChild(u),n.appendChild(i)},t),t++}),shipdisplay(t)}function shipdisplay(t=0){shipsetting=getsetting();for(let e in ship_data)setTimeout(()=>{let t=isshipselect(ship_data[e]);document.getElementById(e).style.display=t?"inline":"none"},t),t++}function equipdisplay(t){shiptype=parseInt(t.getAttribute("stype"),10),equiptype=t.getAttribute("eqtype").split(",");for(let t in equip_data)setTimeout(()=>{let e=equip_data[t],n=equip_data[t].ship_type_forbidden;equiptype.includes(String(e.type))?n.includes(shiptype)?document.getElementById(t).style.display="none":document.getElementById(t).style.display="inline":document.getElementById(t).style.display="none"},0)}function isshipselect(t){let e=[4,5,6,7,12,13];if("front"===fleetpos&&![1,2,3,8,17,18].includes(t.type))return!1;if("back"===fleetpos&&!e.includes(t.type))return!1;let n=!1,i=!1,l=!1,a="nationality";return testship(shipsetting[a],String(t[a]))&&(n=!0),testship(shipsetting[a="type"],String(t[a]))&&(i=!0),testship(shipsetting[a="rarity"],String(t[a]))&&(l=!0),!!(n&&i&&l)&&("1"!==shipsetting[a="retro"]||shipsetting[a]!==String(t[a]))}function testship(t,e){return!(t.length>0)||!!t.includes(e)}function getsetting(){let t={},e=[],n=document.getElementById("shipnation").querySelectorAll("button[aria-pressed=true]"),i=document.getElementById("shiptype").querySelectorAll("button[aria-pressed=true]"),l=document.getElementById("shiprarity").querySelectorAll("button[aria-pressed=true]"),a=["98","101","103","104","105"];n.length>0?(e=[],n.forEach(t=>{"0"===t.value?a.forEach(t=>e.push(t)):e.push(t.value)}),t.nationality=e):t.nationality=[];let s=[1,2,3,8,17,18],r=[4,5,6,7,12,13];i.length>0?(e=[],i.forEach(t=>{let n=parseInt(t.value,10);"front"===fleetpos&&s.includes(n)?e.push(t.value):"back"===fleetpos&&r.includes(n)&&e.push(t.value)}),t.type=e):t.type=[],l.length>0?(e=[],l.forEach(t=>e.push(t.value)),t.rarity=e):t.rarity=[];let o=document.getElementById("shipretro").querySelector("button[aria-pressed=true]");return t.retro=o?o.value:"0",t}ani="",$(document).ready(function(){createmptyship(),$(".btn-outline-light").click(function(){$(this).button("toggle"),shipdisplay(0)})}),String.prototype.len=function(){return this.replace(/[^\x00-\xff]/g,"rr").length};