var shipsetting={},showshiplist={},hidelist=[],current_shipid="",current_shiprar="",newshipid="",fleetpos="",current_equipid="",current_equiptype="";function sorting(t,e,i){return i?(t.sort((t,i)=>t[e]<i[e]?1:-1),t):(t.sort((t,i)=>t[e]>i[e]?1:-1),t)}function setshipbutton(){"front"===fleetpos?(document.getElementById("ffs").style.display="inline",document.getElementById("fbs").style.display="none"):(document.getElementById("ffs").style.display="none",document.getElementById("fbs").style.display="inline")}function setcurrent(t){"shipicon"===t.className?(current_shipid=String(t.id),fleetpos=t.getAttribute("limit"),shipdisplay(0),setshipbutton()):(current_equipid=String(t.id),current_equiptype=t.getAttribute("eqtype"),equipdisplay(t))}function setnewship(t){newshipid=String(t)}function sEquipButton(t,e){var i=t.querySelectorAll(".equip");i.forEach(t=>{t.textContent="",t.style=""}),e?i.forEach(t=>{t.disabled=!1;var e="equip_"+t.getAttribute("pos"),i=ship_data[newshipid];t.setAttribute("eqtype",i[e]),t.setAttribute("stype",i.type)}):i.forEach(t=>t.disabled=!0)}function updateship(t){var e=document.getElementById(current_shipid),i=document.getElementById(current_shipid.slice(0,3));if(e.textContent="",setnewship(t),0===t)return e.setAttribute("style","background-color:gray;"),void sEquipButton(i,!1);sEquipButton(i,!0),document.getElementById(newshipid).querySelectorAll("img").forEach(t=>e.appendChild(t.cloneNode(!0)))}function updateEquip(t){var e=document.getElementById(current_equipid);(e.textContent="",0!==t.id)?document.getElementById(t.id).querySelectorAll("img").forEach(t=>e.appendChild(t.cloneNode(!0))):e.setAttribute("style","background-color:rgb(30.8%, 30.8%, 30.8%);")}function getcolor(t){var e="";switch(t){case 1:case 2:e="lightgray";break;case 3:e="lightblue";break;case 4:e="Plum";break;case 5:e="Gold";break;case 6:e="OrangeRed"}return e}function createmptyship(){var t=document.getElementById("shiplist"),e=document.createElement("button");$(e).attr({type:"button",class:"shipicon",id:"0",style:"display:inline;","data-dismiss":"modal",onclick:"updateship(0)"});var i=document.createElement("img");$(i).attr({src:"shipicon/empty.jpg",class:"main",loading:"lazy"}),e.appendChild(i),t.appendChild(e),creatallships()}function creatallships(){var t=[];for(let e in ship_data)t.push(ship_data[e]);t=sorting(t,"type",!0),t=sorting(t,"nationality",!0),t=sorting(t,"rarity",!0);var e=0;t.forEach(t=>{setTimeout(function(){var e=t,i=document.getElementById("shiplist"),n=document.createElement("button"),s=e.rarity-1;$(n).attr({type:"button",class:"shipicon",id:e.skin_id,style:"display:inline; background-color:"+getcolor(e.rarity)+";","data-dismiss":"modal",onclick:"updateship("+e.skin_id+")"});var a=document.createElement("img");$(a).attr({src:"shipicon/"+e.painting.toLowerCase()+".png",class:"main",loading:"lazy"});var r=document.createElement("img");$(r).attr({src:"ui/bg"+s+".png",class:"bg",loading:"lazy"});var l=document.createElement("img");$(l).attr({src:"ui/frame_"+s+"b.png",class:"frame",loading:"lazy"}),n.appendChild(a),n.appendChild(r),n.appendChild(l),i.appendChild(n)},e),e++}),creatallequips(e)}function creatallequips(t){var e=[];for(let t in equip_data)e.push(equip_data[t]);e=sorting(e,"type",!0),e=sorting(e,"nationality",!0),(e=sorting(e,"rarity",!0)).forEach(e=>{setTimeout(function(){var t=e,i=document.getElementById("equiplist"),n=document.createElement("button"),s=t.rarity;s>1&&s--,$(n).attr({type:"button",class:"equip",id:t.id,style:"display:inline; background-color:"+getcolor(t.rarity)+";","data-dismiss":"modal",onclick:"updateEquip(this)"});var a=document.createElement("img");$(a).attr({src:"equips/"+String(t.icon)+".png",class:"img-rounded img-fluid h-100 main",loading:"lazy"});var r=document.createElement("img");$(r).attr({src:"ui/bg"+s+".png",class:"bg",loading:"lazy"});var l=document.createElement("img");$(l).attr({src:"ui/frame_"+s+"b.png",class:"frame",loading:"lazy"}),n.appendChild(a),n.appendChild(r),n.appendChild(l),i.appendChild(n)},t),t++}),shipdisplay(t)}function shipdisplay(t=0){shipsetting=getsetting();for(let e in ship_data)setTimeout(()=>{let t=isshipselect(ship_data[e]);document.getElementById(e).style.display=t?"inline":"none"},t),t++}function equipdisplay(t){shiptype=parseInt(t.getAttribute("stype"),10),equiptype=t.getAttribute("eqtype").split(",");for(let t in equip_data)setTimeout(()=>{let e=equip_data[t],i=equip_data[t].ship_type_forbidden;equiptype.includes(String(e.type))?i.includes(shiptype)?document.getElementById(t).style.display="none":document.getElementById(t).style.display="inline":document.getElementById(t).style.display="none"},0)}function isshipselect(t){if("front"===fleetpos&&![1,2,3,8,17,18].includes(t.type))return!1;if("back"===fleetpos&&![4,5,6,7,12,13].includes(t.type))return!1;var e=!1,i=!1,n=!1,s="nationality";return testship(shipsetting[s],String(t[s]))&&(e=!0),testship(shipsetting[s="type"],String(t[s]))&&(i=!0),testship(shipsetting[s="rarity"],String(t[s]))&&(n=!0),!!(e&&i&&n)&&("1"!==shipsetting[s="retro"]||shipsetting[s]!==String(t[s]))}function testship(t,e){return!(t.length>0)||!!t.includes(e)}function getsetting(){var t={},e=[],i=document.getElementById("shipnation").querySelectorAll("button[aria-pressed=true]"),n=document.getElementById("shiptype").querySelectorAll("button[aria-pressed=true]"),s=document.getElementById("shiprarity").querySelectorAll("button[aria-pressed=true]"),a=["98","101","103","104","105"];i.length>0?(e=[],i.forEach(t=>{"0"===t.value?a.forEach(t=>e.push(t)):e.push(t.value)}),t.nationality=e):t.nationality=[];var r=[1,2,3,8,17,18],l=[4,5,6,7,12,13];n.length>0?(e=[],n.forEach(t=>{var i=parseInt(t.value,10);"front"===fleetpos&&r.includes(i)?e.push(t.value):"back"===fleetpos&&l.includes(i)&&e.push(t.value)}),t.type=e):t.type=[],s.length>0?(e=[],s.forEach(t=>e.push(t.value)),t.rarity=e):t.rarity=[];var p=document.getElementById("shipretro").querySelector("button[aria-pressed=true]");return t.retro=p?p.value:"0",t}$(document).ready(function(){createmptyship(),$(".btn-outline-light").click(function(){$(this).button("toggle"),shipdisplay(0)})});